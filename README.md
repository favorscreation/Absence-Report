# 欠席・遅刻・早退連絡票システム

## プロジェクト概要

このプロジェクトは、Google Apps Script（GAS）とクライアントサイドのJavaScriptを使用して、フォームデータをGoogleスプレッドシートに自動的に追加するシステムです。クロスオリジンリソース共有（CORS）の問題を回避しながら、データ送信とレスポンスの処理を行います。

## 構成ファイル

- `main.gs`：Google Apps Script側のメインスクリプト
- `index.html`：フォームを含むHTMLファイル
- `scripts.js`：クライアントサイドのJavaScriptファイル

## システムの詳細

### 1. Google Apps Script (GAS)

Google Apps Scriptは、このプロジェクトのバックエンドを担い、フォームから送信されたデータをGoogleスプレッドシートに追加します。また、GAS側でCORSの問題を回避するためのヘッダー設定も行います。

#### 主な機能
- **doGet関数**: 確認用にシンプルなレスポンスを返します。
- **doPost関数**: フォームデータを受け取り、指定されたスプレッドシートにデータを追加します。
- **UUID生成**: 重複送信を防ぐためにUUIDを生成し、チェックを行います。
- **ヘッダー行の追加**: スプレッドシートにデータを追加する前に、ヘッダー行が存在しない場合は自動的に追加します。

### 2. フロントエンド (HTMLとJavaScript)

フロントエンドでは、ユーザーが入力するためのフォームが提供され、JavaScriptがそのデータを収集してGASに送信します。

#### 主な機能
- **フォームデータの収集**: ユーザーがフォームに入力したデータを収集します。
- **POSTリクエストの送信**: `fetch`を使用して、フォームデータをPOSTリクエストでGASに送信します。
- **デバッグモード**: クエリパラメータでデバッグモードを設定し、テストデータを自動入力できます。
- **バリデーション**: フォームのバリデーションを行い、入力データの整合性をチェックします。

### 3. デプロイメントと実行

システムはGoogle Apps Scriptとしてデプロイされ、公開URLを使用してフォームデータを受け取ります。

#### デプロイ手順
1. **Google Apps Script**: スクリプトエディタに `main.gs` の内容を貼り付けて保存します。
2. **デプロイ**: ウェブアプリとしてデプロイし、アクセスを「全員（匿名ユーザーを含む）」に設定します。
3. **フォーム**: `index.html` と `scripts.js` をホスティングし、GASの公開URLに対してフォームデータを送信するように設定します。

### 4. カスタマイズと拡張

このシステムは柔軟にカスタマイズおよび拡張可能です。例えば、スプレッドシートのカラム名が変更された場合でも、コード内の定数やマッピングを修正することで対応できます。また、新しいフィールドを追加する場合も、同様の手順で対応できます。
